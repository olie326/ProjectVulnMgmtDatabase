export type vulnerability = {
  type: "Vulnerability";
  vulnerability_id: string;
  definition: number;
  Vulnerability: number;
  first_observed: Date;
  last_seen: Date;
  output: string;
  risk_modified: string;
  severity: string;
  state: string;
};

export type vulnerabilityRaw = Omit<
  vulnerability,
  "first_observed" | "last_seen"
> & {
  first_observed: string;
  last_seen: string;
};

export function isVulnerability(fields: any): fields is vulnerability {
  return (
    fields.vulnerability_id != undefined &&
    typeof fields.first_observed === "object"
  );
}

export function isVulnerabilityRaw(fields: any): fields is vulnerabilityRaw {
  return (
    fields.vulnerability_id != undefined &&
    (typeof fields.first_observed === "string" || fields.first_observed == null)
  );
}

export class Vulnerability implements vulnerability {
  readonly type: "Vulnerability";
  vulnerability_id: string;
  definition: number;
  Vulnerability: number;
  first_observed: Date;
  last_seen: Date;
  output: string;
  risk_modified: string;
  severity: string;
  state: string;

  constructor(props: Partial<vulnerability> = {}) {
    //optimize this code. Its long and tedious. Can loop through somehow?
    this.type = "Vulnerability";
    this.vulnerability_id = props.vulnerability_id || "";
    this.definition = props.definition || -1;
    this.Vulnerability = props.Vulnerability || -1;
    this.first_observed = props.first_observed || new Date();
    this.last_seen = props.last_seen || new Date();
    this.output = props.output || "";
    this.risk_modified = props.risk_modified || "";
    this.severity = props.severity || "";
    this.state = props.state || "";
  }
}
